(this.webpackJsonpjira=this.webpackJsonpjira||[]).push([[0],{204:function(e,t,n){},367:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(28),u=n.n(c),o=(n(204),n(18)),i=n.n(o),s=n(51),l="https://online.com",f="__auth_provider_token__",d=function(e){var t=e.user;return window.localStorage.setItem(f,t.token||""),t},p=function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.localStorage.removeItem(f));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=n(49),m=n(194),v=n(164),h=n.n(v),j="https://online.com",g=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r,a,c,u,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},r=n.data,a=n.token,n.headers,c=Object(m.a)(n,["data","token","headers"]),"GET"===(u=Object(b.a)({method:"GET",headers:{Authorization:a?"Bearer ".concat(a):"","Content-Type":r?"application/json":""}},c)).method.toUpperCase()?t+="?".concat(h.a.stringify(r)):u.body=JSON.stringify(r||{}),e.abrupt("return",window.fetch("".concat(j,"/").concat(t),u).then(function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=5;break}return e.next=3,p();case 3:return window.location.reload(),e.abrupt("return",Promise.reject({message:"\u8bf7\u91cd\u65b0\u767b\u5f55"}));case 5:return e.next=7,t.json();case 7:if(n=e.sent,!t.ok){e.next=12;break}return e.abrupt("return",n);case 12:return e.abrupt("return",Promise.reject(n));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();n(71);var O=n(34),w={stat:"idle",data:null,error:null},y={throwOnError:!1},E=function(e){var t=function(){var e=Object(r.useRef)(!1);return Object(r.useEffect)((function(){return e.current=!0,function(){e.current=!1}})),e}();return Object(r.useCallback)((function(){return t.current?e.apply(void 0,arguments):void 0}),[e,t])},k=n(98),x=n(99),C=n(183),S=n(372),P=n(190),T=n(96);function I(){var e=Object(k.a)(["\n  padding: 3.2rem;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return I=function(){return e},e}function A(){var e=Object(k.a)(["\n  padding: 0;\n"]);return A=function(){return e},e}function _(){var e=Object(k.a)(["\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return _=function(){return e},e}function F(){var e=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: ",";\n  margin-bottom: ",";\n\n  > * {\n    margin-top: 0 !important;\n    margin-bottom: 0 !important;\n    margin-right: ",";\n  }\n"]);return F=function(){return e},e}x.a.div(F(),(function(e){return e.between?"space-between":void 0}),(function(e){return e.marginBottom+"rem"}),(function(e){return"number"===typeof e.gap?e.gap+"rem":e.gap?"2rem":void 0}));var J=x.a.div(_()),N=function(){return a.a.createElement(J,null,a.a.createElement(C.a,{size:"large"}))},B=function(e){var t=e.error;return a.a.createElement(J,null,a.a.createElement(T.a,null),a.a.createElement(D,{error:t}))},D=function(e){var t,n=e.error;return(null===(t=n)||void 0===t?void 0:t.message)?a.a.createElement(S.a.Text,{type:"danger"},null===n||void 0===n?void 0:n.message):null},L=(Object(x.a)(P.a)(A()),x.a.div(I()),n(370)),R=function(){var e=Object(s.a)(i.a.mark((function e(){var t,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!(n=window.localStorage.getItem(f))){e.next=7;break}return e.next=5,g("me",{token:n});case 5:r=e.sent,t=r.user;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=a.a.createContext(void 0);z.displayName="AuthContext";var G=function(e){var t,n=e.children,c=function(e,t){var n=Object(b.a)(Object(b.a)({},y),t),a=Object(r.useReducer)((function(e,t){return Object(b.a)(Object(b.a)({},e),t)}),Object(b.a)(Object(b.a)({},w),e)),c=Object(O.a)(a,2),u=c[0],o=c[1],i=E(o),s=Object(r.useState)((function(){return function(){}})),l=Object(O.a)(s,2),f=l[0],d=l[1],p=Object(r.useCallback)((function(e){return i({data:e,stat:"success",error:null})}),[i]),m=Object(r.useCallback)((function(e){return i({error:e,stat:"error",data:null})}),[i]),v=Object(r.useCallback)((function(e,t){if(!e||!e.then)throw new Error("\u8bf7\u4f20\u5165 Promise \u7c7b\u578b\u6570\u636e");return d((function(){return function(){(null===t||void 0===t?void 0:t.retry)&&v(null===t||void 0===t?void 0:t.retry(),t)}})),i({stat:"loading"}),e.then((function(e){return p(e),e})).catch((function(e){return m(e),n.throwOnError?Promise.reject(e):e}))}),[n.throwOnError,p,m,i]);return Object(b.a)({isIdle:"idle"===u.stat,isLoading:"loading"===u.stat,isError:"error"===u.stat,isSuccess:"success"===u.stat,run:v,setData:p,setError:m,retry:f},u)}(),u=c.data,o=c.error,f=c.isLoading,m=c.isIdle,v=c.isError,h=c.run,j=c.setData,g=Object(L.b)();return t=function(){h(R())},Object(r.useEffect)((function(){t()}),[]),m||f?a.a.createElement(N,null):v?a.a.createElement(B,{error:o}):a.a.createElement(z.Provider,{children:n,value:{user:u,login:function(e){return(t=e,fetch("".concat(l,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=8;break}return e.t0=d,e.next=4,t.json();case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.t2=Promise,e.next=11,t.json();case 11:return e.t3=e.sent,e.abrupt("return",e.t2.reject.call(e.t2,e.t3));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then(j);var t},register:function(e){return(t=e,fetch("".concat(l,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=8;break}return e.t0=d,e.next=4,t.json();case 4:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:return e.t2=Promise,e.next=11,t.json();case 11:return e.t3=e.sent,e.abrupt("return",e.t2.reject.call(e.t2,e.t3));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then(j);var t},logout:function(){return p().then((function(){j(null),g.clear()}))}}})},M=function(){var e=a.a.useContext(z);if(!e)throw new Error("useAuth\u5fc5\u987b\u5728AuthProvider\u4e2d\u4f7f\u7528");return e},U=n(105),q=n(187),H=n(106),K=n(122),Q=function(e){Object(H.a)(n,e);var t=Object(K.a)(n);function n(){var e;Object(U.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={error:null},e}return Object(q.a)(n,[{key:"render",value:function(){var e=this.state.error,t=this.props,n=t.fallbackRender,r=t.children;return e?n({error:e}):r}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(a.a.Component);var V=function(){return M().user,a.a.createElement("div",{className:"App"},a.a.createElement(Q,{fallbackRender:B}))},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,373)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,u=t.getTTFB;n(e),r(e),a(e),c(e),u(e)}))},X=(n(366),n(371)),Y=function(e){var t=e.children,n=new X.a;return a.a.createElement(L.a,{client:n},a.a.createElement(G,null,t))};Object(T.b)((function(){return u.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Y,null,a.a.createElement(T.a,null),a.a.createElement(V,null))),document.getElementById("root"))})),W()}},[[367,1,2]]]);
//# sourceMappingURL=main.f9cc4908.chunk.js.map